<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, viewport-fit=cover"
        />
        <title>Reader</title>
        <meta name="description" content="A modern ebook reader" />
        <link rel="icon" href="/favicon.ico" />
        <link
            rel="apple-touch-icon"
            href="/apple-touch-icon.png"
            sizes="180x180"
        />
        <link rel="mask-icon" href="/mask-icon.svg" color="#FFFFFF" />
        <meta name="theme-color" content="#ffffff" />

        <!-- Inline script to apply theme immediately before render to prevent flash -->
        <script>
            (function () {
                const STORAGE_KEY = "epub-reader-settings";
                const THEME_CLASSES = [
                    "light",
                    "dark",
                    "flexoki-light",
                    "flexoki-dark",
                ];
                const DEFAULT_THEME = "light";

                try {
                    const stored = localStorage.getItem(STORAGE_KEY);
                    const settings = stored ? JSON.parse(stored) : null;
                    const theme =
                        settings?.theme &&
                        THEME_CLASSES.includes(settings.theme)
                            ? settings.theme
                            : DEFAULT_THEME;
                    document.documentElement.classList.add(theme);
                } catch (e) {
                    document.documentElement.classList.add(DEFAULT_THEME);
                }
            })();
        </script>

        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400&family=Lora:ital,wght@0,400;0,500;0,600;1,400&display=swap"
            rel="stylesheet"
        />
    </head>
    <body>
        <div id="root"></div>
        <script type="module" src="/src/main.tsx"></script>
    </body>
</html>
